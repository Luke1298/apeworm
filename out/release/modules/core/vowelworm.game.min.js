(function(){window.VowelWorm.Game=function(g){var a=this;a.width=g.width||700;a.height=g.height||500;a.x1=-1;a.x2=2;a.y1=-1;a.y2=3;a.minHz=300;a.maxHz=8E3;a.fb=10;a.silence=-70;var l=[],k=!0,h=new PIXI.DisplayObjectContainer;a.play=function(){a.drawWorm();window.requestAnimationFrame(a.play)};a.addWorm=function(a){var b={};b.worm=a;b.circles=[];l.push(b)};a.drawWorm=function(){var d=65280;l.forEach(function(b){var c=b.circles,f;b=b.worm;f=b.getFFT();var e;b:{for(e=0;e<f.length;e++)if(f[e]>a.silence){e=!1;break b}e=
!0}e?f=null:(b=b.getMFCCs({minFreq:a.minHz,maxFreq:a.maxHz,filterBanks:a.fb,fft:f}),b.length?(f=a.x1,e=a.y1,b={x:a.width/(a.x2-f)*(b[2]-f),y:a.height-a.height/(a.y2-e)*(-b[1]-e)}):b=null,f=b);null!==f&&(b=f.x,f=f.y,e=new PIXI.Sprite.fromImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZBAMAAAA2x5hQAAAAJ1BMVEUAAAD///////////////// //////////////////////////////+uPUo5AAAADHRSTlMAB+jh0bmoiU41HivIpyZzAAAAeklE QVQY02MAAsbpQYfCJwIZYE7LGSA40gjhLTsDBscWgDjcNmcgwBrEW3wGCg4DJRlzzsBAIgMDxxk4 OMHAIILgHRFgmHMGASYw1CDxChhikHgBDDpIPAWGM0jgAKocqj5UM1HtQ3ULijtR/YDqPwy/I8IF PcxQwxMAviHDkWPqCWAAAAAASUVORK5CYII="),
e.position.x=b,e.position.y=f,e.tint=d,c.push(e),a._stage.addChild(e));c=d;if("number"==typeof c)for(c=c.toString(16);6>c.length;)c="0"+c;c=new tinycolor(c);c=c.spin(45).toHex();d=c=parseInt(c,16)});m();a._renderer.render(a._stage)};Object.defineProperties(a,{ipa:{enumerable:!0,get:function(){return k},set:function(d){d=!!d;k!==d&&((k=d)?a._stage.addChild(h):a._stage.removeChild(h),window.requestAnimationFrame(a._renderer.render))}}});var m=function(){l.forEach(function(d){d=d.circles;for(var b=0;b<
d.length;b++){var c=d[b];c.alpha-=0.2;0>=c.alpha&&(a._stage.removeChild(c),d.splice(b,1),b--)}})};a._stage=new PIXI.Stage(void 0!==g.background?g.background:16777215);a._renderer=PIXI.autoDetectRenderer(a.width,a.height);try{g.element.appendChild(a._renderer.view)}catch(n){document.body.appendChild(a._renderer.view)}(function(){if(!h.children.length)for(var a=[["e",221.28871891963863,252.35519027188354],["i",169.01833799969594,171.97765003235634],["a",317.6219414250667,337.00896411883406],["o",384.5714404194302,
284.96641792056766],["u",412.17314090483404,231.94657762575406]],b=0;b<a.length;b++){var c=new PIXI.Text(a[b][0],{font:"35px sans-serif",fill:"black",align:"center"});c.position.x=a[b][1];c.position.y=a[b][2];h.addChild(c)}})();k&&a._stage.addChild(h);g.worms&&(g.worms instanceof Array?g.worms.forEach(function(d){a.addWorm(d)}):a.addWorm(g.worms));a._renderer.render(a._stage);a.play()};}).call(this);
